---
const faqs = [
  {
    question: "¿Cuánto tiempo dura una sesión de entrenamiento?",
    answer: "Las sesiones de entrenamiento personalizado duran entre 60-90 minutos, dependiendo de tus objetivos y nivel de condición física. Incluyen calentamiento, entrenamiento principal y estiramiento."
  },
  {
    question: "¿Necesito experiencia previa en el gym?",
    answer: "¡Para nada! Trabajo con personas de todos los niveles, desde principiantes absolutos hasta atletas avanzados. Adapto cada rutina a tu nivel actual y progresamos juntos."
  },
  {
    question: "¿Dónde se realizan las sesiones?",
    answer: "Ofrezco sesiones en mi gimnasio, a domicilio (según ubicación) y también sesiones virtuales online para que puedas entrenar desde donde estés."
  },
  {
    question: "¿Incluyes plan de alimentación?",
    answer: "Sí, todos mis planes de entrenamiento personalizado incluyen guías nutricionales básicas. También ofrezco planes nutricionales completos y detallados como servicio adicional."
  },
  {
    question: "¿Con qué frecuencia debo entrenar?",
    answer: "Depende de tus objetivos, pero recomiendo mínimo 3 sesiones por semana para ver resultados consistentes. Crearemos un horario que se adapte a tu disponibilidad."
  },
  {
    question: "¿Cuánto tiempo toma ver resultados?",
    answer: "Los primeros cambios se notan en 2-3 semanas (más energía, mejor sueño). Cambios físicos visibles generalmente en 4-8 semanas con consistencia. Cada cuerpo es diferente."
  },
  {
    question: "¿Qué pasa si tengo una lesión o condición médica?",
    answer: "Trabajo con cuidado adaptando ejercicios según tus necesidades. Es importante informarme sobre cualquier condición médica para diseñar un programa seguro y efectivo."
  },
  {
    question: "¿Ofreces planes para grupos o parejas?",
    answer: "¡Sí! Tengo opciones para entrenar en pareja o grupos pequeños (máx 4 personas). Es una excelente manera de motivarse mutuamente y hacer el proceso más divertido."
  }
];
---

<section id="faq" class="faq-section">
  <div class="faq-container">
    <!-- Header -->
    <div class="faq-header">
      <span class="faq-badge">
        Preguntas Frecuentes
      </span>
      <h2 class="faq-title">
        ¿Tienes Dudas?
      </h2>
      <p class="faq-subtitle">
        Aquí están las respuestas a las preguntas más comunes
      </p>
    </div>

    <!-- FAQ Grid -->
    <div class="faq-content">
      <div class="faq-grid">
        {faqs.map((faq, index) => (
          <div class="faq-item">
            <button 
              class="faq-question"
              aria-expanded="false"
              data-faq-index={index}
            >
              <span class="faq-question-text">
                {faq.question}
              </span>
              <svg class="faq-icon" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5">
                <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7" />
              </svg>
            </button>
            <div class="faq-answer" style="max-height: 0;">
              <div class="faq-answer-content">
                {faq.answer}
              </div>
            </div>
          </div>
        ))}
      </div>
    </div>

    <!-- CTA Bottom -->
    <div class="faq-cta">
      <h3 class="faq-cta-title">
        ¿No encuentras tu respuesta?
      </h3>
      <p class="faq-cta-text">
        Contáctame directamente y resolveré todas tus dudas
      </p>
      <a 
        href="/contacto" 
        class="faq-cta-button"
      >
        Hacer una Consulta
        <svg class="faq-cta-icon" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5">
          <path stroke-linecap="round" stroke-linejoin="round" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" />
        </svg>
      </a>
    </div>
  </div>
</section>

<script is:inline>
  (function() {
    function initFAQ() {
      const faqButtons = document.querySelectorAll('.faq-question');
      
      faqButtons.forEach(button => {
        button.addEventListener('click', () => {
          const faqItem = button.closest('.faq-item');
          const answer = faqItem?.querySelector('.faq-answer');
          const icon = button.querySelector('.faq-icon');
          const isExpanded = button.getAttribute('aria-expanded') === 'true';
          
          // SIEMPRE cerrar todos los demás primero
          faqButtons.forEach(otherButton => {
            if (otherButton !== button) {
              const otherItem = otherButton.closest('.faq-item');
              const otherAnswer = otherItem?.querySelector('.faq-answer');
              const otherIcon = otherButton.querySelector('.faq-icon');
              
              otherButton.setAttribute('aria-expanded', 'false');
              if (otherAnswer) {
                otherAnswer.style.maxHeight = '0';
                otherAnswer.style.transition = 'max-height 0.3s ease-in-out';
              }
              if (otherIcon) otherIcon.style.transform = 'rotate(0deg)';
            }
          });
          
          // Toggle el actual (solo se abre si estaba cerrado)
          if (isExpanded) {
            // Si estaba abierto, cerrarlo
            button.setAttribute('aria-expanded', 'false');
            if (answer) {
              answer.style.maxHeight = '0';
              answer.style.transition = 'max-height 0.3s ease-in-out';
            }
            if (icon) icon.style.transform = 'rotate(0deg)';
          } else {
            // Si estaba cerrado, abrirlo
            button.setAttribute('aria-expanded', 'true');
            if (answer) {
              const answerContent = answer.querySelector('.faq-answer-content');
              if (answerContent) {
                answer.style.transition = 'max-height 0.3s ease-in-out';
                answer.style.maxHeight = answerContent.scrollHeight + 'px';
              }
            }
            if (icon) icon.style.transform = 'rotate(180deg)';
          }
        });
      });
    }
    
    // Inicializar
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', initFAQ);
    } else {
      initFAQ();
    }
    
    // Reinicializar después de transiciones de Astro
    document.addEventListener('astro:after-swap', initFAQ);
  })();
</script>

<style>
  /* FAQ Section - Sin scroll interno, todo debe caber */
  .faq-section {
    position: relative;
    width: 100%;
    min-height: 100svh;
    display: flex;
    align-items: stretch;
    justify-content: stretch;
    overflow: hidden;
    box-sizing: border-box;
    background-color: #111827;
  }

  .faq-container {
    position: relative;
    z-index: 10;
    width: 100%;
    max-width: 1400px;
    margin: 0 auto;
    height: 100svh;
    min-height: 100svh;
    display: flex;
    flex-direction: column;
    padding: var(--header-h, 64px) clamp(1rem, 4vw, 2rem) clamp(0.125rem, 0.5svh, 0.5rem);
    box-sizing: border-box;
  }

  /* Header */
  .faq-header {
    text-align: center;
    padding: clamp(0.25rem, 1svh, 0.5rem) 0;
    flex-shrink: 0;
    box-sizing: border-box;
  }

  .faq-badge {
    display: inline-block;
    padding: clamp(0.375rem, 1.2svh, 0.5rem) clamp(0.875rem, 2.2vw, 1.25rem);
    background-color: rgba(0, 255, 136, 0.1);
    color: #00FF88;
    border-radius: 9999px;
    font-size: clamp(0.6875rem, 1.6svh, 0.8125rem);
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    margin-bottom: clamp(0.375rem, 1.2svh, 0.5rem);
  }

  .faq-title {
    font-size: clamp(1.75rem, 6vw, 3rem);
    font-weight: 900;
    color: #ffffff;
    line-height: 1.1;
    margin: 0 0 clamp(0.25rem, 0.8svh, 0.375rem) 0;
    flex-shrink: 0;
  }

  .faq-subtitle {
    font-size: clamp(0.875rem, 2svh, 1.0625rem);
    color: #d1d5db;
    line-height: 1.4;
    margin: 0;
    flex-shrink: 0;
  }

  /* Content */
  .faq-content {
    flex: 1;
    overflow: hidden;
    padding: clamp(0.5rem, 1.5svh, 0.75rem) 0;
    min-height: 0;
    box-sizing: border-box;
    display: flex;
    align-items: flex-start;
    justify-content: center;
  }

  .faq-grid {
    display: grid;
    grid-template-columns: repeat(1, 1fr);
    gap: clamp(0.5rem, 1.5svh, 0.75rem);
    width: 100%;
    overflow: visible;
  }

  @media (min-width: 1024px) {
    .faq-grid {
      grid-template-columns: repeat(2, 1fr);
      gap: clamp(0.625rem, 1.8svh, 0.875rem);
      align-content: start;
    }
  }

  /* FAQ Items */
  .faq-item {
    background-color: rgba(31, 41, 55, 0.6);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 0.75rem;
    overflow: hidden;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    transition: box-shadow 0.3s ease;
    height: auto;
    min-height: auto;
  }

  .faq-item:hover {
    box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
  }

  .faq-question {
    width: 100%;
    text-align: left;
    padding: clamp(0.625rem, 1.5svh, 0.875rem) clamp(1rem, 2.5vw, 1.25rem);
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 0.75rem;
    background-color: transparent;
    border: none;
    cursor: pointer;
    transition: background-color 0.3s ease;
    box-sizing: border-box;
  }

  .faq-question:hover {
    background-color: rgba(31, 41, 55, 0.7);
  }

  .faq-question-text {
    font-size: clamp(0.875rem, 2svh, 1rem);
    font-weight: 700;
    color: #ffffff;
    line-height: 1.25;
    flex: 1;
    word-wrap: break-word;
    overflow-wrap: break-word;
  }

  .faq-icon {
    width: clamp(1rem, 2.5svh, 1.25rem);
    height: clamp(1rem, 2.5svh, 1.25rem);
    color: #00FF88;
    flex-shrink: 0;
    transition: transform 0.3s ease;
  }

  .faq-answer {
    overflow: hidden;
    transition: max-height 0.3s ease-in-out;
  }

  .faq-answer-content {
    padding: 0 clamp(1rem, 2.5vw, 1.25rem) clamp(0.625rem, 1.5svh, 0.875rem);
    color: #d1d5db;
    line-height: 1.4;
    font-size: clamp(0.8125rem, 1.8svh, 0.875rem);
    word-wrap: break-word;
    overflow-wrap: break-word;
  }

  /* CTA */
  .faq-cta {
    text-align: center;
    padding: clamp(0.625rem, 1.8svh, 0.875rem) clamp(0.875rem, 2.2vw, 1.25rem);
    background: linear-gradient(to right, #00FF88, #00FFAA);
    border-radius: 0.75rem;
    margin-top: clamp(0.5rem, 1.5svh, 0.75rem);
    flex-shrink: 0;
    box-sizing: border-box;
  }

  .faq-cta-title {
    font-size: clamp(0.9375rem, 2.2svh, 1.125rem);
    font-weight: 700;
    color: #0b0b0b;
    margin: 0 0 clamp(0.25rem, 0.8svh, 0.375rem) 0;
    flex-shrink: 0;
  }

  .faq-cta-text {
    font-size: clamp(0.75rem, 1.6svh, 0.875rem);
    color: rgba(11, 11, 11, 0.9);
    margin: 0 0 clamp(0.375rem, 1.2svh, 0.5rem) 0;
    flex-shrink: 0;
  }

  .faq-cta-button {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: clamp(0.4375rem, 1.2svh, 0.5625rem) clamp(1.125rem, 3vw, 1.625rem);
    font-size: clamp(0.75rem, 1.6svh, 0.875rem);
    font-weight: 700;
    border-radius: 9999px;
    background-color: #ffffff;
    color: #00FF88;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    transition: all 0.3s ease;
    text-decoration: none;
    transform: scale(1);
  }

  .faq-cta-button:hover {
    background-color: #f3f4f6;
    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
    transform: scale(1.05);
  }

  .faq-cta-icon {
    width: clamp(1.25rem, 3svh, 1.5rem);
    height: clamp(1.25rem, 3svh, 1.5rem);
    margin-left: 0.5rem;
    color: #00FF88;
  }

  /* Responsive - Mobile */
  @media (max-width: 767px) {
    .faq-container {
      padding: 0 clamp(1rem, 4vw, 1.5rem) clamp(0.125rem, 0.5svh, 0.5rem);
      padding-top: var(--header-h, 64px);
      height: 100svh;
      min-height: 100svh;
    }
    .faq-header {
      padding: clamp(0.25rem, 1svh, 0.5rem) 0;
    }
    .faq-badge {
      padding: clamp(0.375rem, 1.2svh, 0.5rem) clamp(0.875rem, 2.2vw, 1.25rem);
      font-size: clamp(0.6875rem, 1.6svh, 0.8125rem);
      margin-bottom: clamp(0.375rem, 1.2svh, 0.5rem);
    }
    .faq-title {
      font-size: clamp(1.5rem, 5vw, 2rem);
      margin-bottom: clamp(0.25rem, 0.8svh, 0.375rem);
    }
    .faq-subtitle {
      font-size: clamp(0.875rem, 2svh, 1rem);
    }
    .faq-content {
      padding: clamp(0.375rem, 1.2svh, 0.625rem) 0;
    }
    .faq-grid {
      gap: clamp(0.5rem, 1.5svh, 0.75rem);
    }
    .faq-item {
      border-radius: 0.625rem;
    }
    .faq-question {
      padding: clamp(0.625rem, 1.5svh, 0.875rem) clamp(0.875rem, 2.2vw, 1.125rem);
      gap: 0.625rem;
    }
    .faq-question-text {
      font-size: clamp(0.875rem, 2svh, 1rem);
      line-height: 1.25;
    }
    .faq-icon {
      width: clamp(1rem, 2.5svh, 1.25rem);
      height: clamp(1rem, 2.5svh, 1.25rem);
    }
    .faq-answer-content {
      padding: 0 clamp(0.875rem, 2.2vw, 1.125rem) clamp(0.625rem, 1.5svh, 0.875rem);
      font-size: clamp(0.8125rem, 1.8svh, 0.9375rem);
    }
    .faq-cta {
      padding: clamp(0.625rem, 1.8svh, 0.875rem) clamp(0.875rem, 2.2vw, 1.25rem);
      margin-top: clamp(0.5rem, 1.5svh, 0.75rem);
    }
    .faq-cta-title {
      font-size: clamp(0.9375rem, 2.2svh, 1.125rem);
      margin-bottom: clamp(0.25rem, 0.8svh, 0.375rem);
    }
    .faq-cta-text {
      font-size: clamp(0.75rem, 1.6svh, 0.875rem);
      margin-bottom: clamp(0.375rem, 1.2svh, 0.5rem);
    }
    .faq-cta-button {
      padding: clamp(0.4375rem, 1.2svh, 0.5625rem) clamp(1.125rem, 3vw, 1.625rem);
      font-size: clamp(0.75rem, 1.6svh, 0.875rem);
    }
  }

  /* Responsive - Tablet */
  @media (min-width: 768px) and (max-width: 1023px) {
    .faq-header {
      padding: clamp(1rem, 2.5svh, 1.5rem) 0;
    }
    .faq-title {
      font-size: clamp(2.5rem, 8vw, 3.5rem);
    }
    .faq-subtitle {
      font-size: clamp(1.125rem, 2.8svh, 1.375rem);
    }
    .faq-content {
      padding: clamp(0.75rem, 2svh, 1.25rem) 0;
    }
    .faq-grid {
      gap: clamp(0.875rem, 2.2svh, 1.125rem);
    }
  }

  /* Responsive - Desktop */
  @media (min-width: 1024px) {
    .faq-header {
      padding: clamp(0.375rem, 1.2svh, 0.625rem) 0;
    }
    .faq-badge {
      padding: clamp(0.375rem, 1.2svh, 0.5rem) clamp(0.875rem, 2.2vw, 1.25rem);
      font-size: clamp(0.6875rem, 1.6svh, 0.8125rem);
      margin-bottom: clamp(0.375rem, 1.2svh, 0.5rem);
    }
    .faq-title {
      font-size: clamp(2rem, 6vw, 2.5rem);
      margin-bottom: clamp(0.25rem, 0.8svh, 0.375rem);
    }
    .faq-subtitle {
      font-size: clamp(0.875rem, 2svh, 1.0625rem);
    }
    .faq-content {
      padding: clamp(0.5rem, 1.5svh, 0.75rem) 0;
    }
    .faq-grid {
      gap: clamp(0.625rem, 1.8svh, 0.875rem);
    }
    .faq-item {
      border-radius: 0.75rem;
    }
    .faq-question {
      padding: clamp(0.75rem, 2svh, 1rem) clamp(1.125rem, 2.8vw, 1.375rem);
    }
    .faq-question-text {
      font-size: clamp(0.9375rem, 2.2svh, 1.0625rem);
      line-height: 1.25;
    }
    .faq-icon {
      width: clamp(1rem, 2.5svh, 1.25rem);
      height: clamp(1rem, 2.5svh, 1.25rem);
    }
    .faq-answer-content {
      padding: 0 clamp(1.125rem, 2.8vw, 1.375rem) clamp(0.75rem, 2svh, 1rem);
      font-size: clamp(0.875rem, 2svh, 0.9375rem);
      line-height: 1.4;
    }
    .faq-cta {
      padding: clamp(0.625rem, 1.8svh, 0.875rem) clamp(0.875rem, 2.2vw, 1.25rem);
      margin-top: clamp(0.5rem, 1.5svh, 0.75rem);
    }
    .faq-cta-title {
      font-size: clamp(0.9375rem, 2.2svh, 1.125rem);
      margin-bottom: clamp(0.25rem, 0.8svh, 0.375rem);
    }
    .faq-cta-text {
      font-size: clamp(0.75rem, 1.6svh, 0.875rem);
      margin-bottom: clamp(0.375rem, 1.2svh, 0.5rem);
    }
    .faq-cta-button {
      padding: clamp(0.4375rem, 1.2svh, 0.5625rem) clamp(1.125rem, 3vw, 1.625rem);
      font-size: clamp(0.75rem, 1.6svh, 0.875rem);
    }
  }

  /* Fallback para pantallas con poca altura */
  @media (max-height: 600px) {
    .faq-header {
      padding: clamp(0.5rem, 1.2svh, 0.75rem) 0;
    }
    .faq-badge {
      padding: clamp(0.375rem, 1svh, 0.5rem) clamp(0.75rem, 2vw, 1rem);
      font-size: clamp(0.625rem, 1.4svh, 0.75rem);
      margin-bottom: clamp(0.375rem, 1svh, 0.5rem);
    }
    .faq-title {
      font-size: clamp(1.5rem, 5vw, 2rem);
      margin-bottom: clamp(0.25rem, 0.8svh, 0.5rem);
    }
    .faq-subtitle {
      font-size: clamp(0.875rem, 2svh, 1rem);
    }
    .faq-content {
      padding: clamp(0.25rem, 0.8svh, 0.5rem) 0;
    }
    .faq-grid {
      gap: clamp(0.5rem, 1.2svh, 0.75rem);
    }
    .faq-question {
      padding: clamp(0.75rem, 1.8svh, 1rem) clamp(1rem, 2.5vw, 1.25rem);
    }
    .faq-question-text {
      font-size: clamp(0.875rem, 2svh, 1rem);
    }
    .faq-answer-content {
      padding: 0 clamp(1rem, 2.5vw, 1.25rem) clamp(0.75rem, 1.8svh, 1rem);
      font-size: clamp(0.8125rem, 1.8svh, 0.9375rem);
    }
    .faq-cta {
      padding: clamp(1rem, 2.5svh, 1.5rem) clamp(1rem, 2.5vw, 1.5rem);
      margin-top: clamp(0.5rem, 1.2svh, 0.75rem);
    }
    .faq-cta-title {
      font-size: clamp(1.125rem, 3vw, 1.5rem);
      margin-bottom: clamp(0.375rem, 1svh, 0.5rem);
    }
    .faq-cta-text {
      font-size: clamp(0.875rem, 2svh, 1rem);
      margin-bottom: clamp(0.5rem, 1.2svh, 0.75rem);
    }
    .faq-cta-button {
      padding: clamp(0.625rem, 1.5svh, 0.75rem) clamp(1.5rem, 4vw, 2rem);
      font-size: clamp(0.875rem, 2svh, 1rem);
    }
  }
</style>
