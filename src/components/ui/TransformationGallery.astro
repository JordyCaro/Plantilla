---
const transformations = [
  {
    id: 1,
    nombre: "María G.",
    objetivo: "Pérdida de Peso",
    resultado: "-20kg en 6 meses",
    imagenAntes: "https://images.unsplash.com/photo-1438761681033-6461ffad8d80?auto=format&fit=crop&q=80&w=400",
    imagenDespues: "https://images.unsplash.com/photo-1494790108377-be9c29b29330?auto=format&fit=crop&q=80&w=400",
    testimonio: "Jairo cambió mi vida completamente. No solo perdí peso, gané confianza."
  },
  {
    id: 2,
    nombre: "Carlos R.",
    objetivo: "Ganancia Muscular",
    resultado: "+12kg de músculo",
    imagenAntes: "https://images.unsplash.com/photo-1500648767791-00dcc994a43e?auto=format&fit=crop&q=80&w=400",
    imagenDespues: "https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?auto=format&fit=crop&q=80&w=400",
    testimonio: "El entrenamiento con Jairo es intenso pero los resultados hablan por sí solos."
  },
  {
    id: 3,
    nombre: "Laura M.",
    objetivo: "Cambio de Hábitos",
    resultado: "Estilo de vida saludable",
    imagenAntes: "https://images.unsplash.com/photo-1438761681033-6461ffad8d80?auto=format&fit=crop&q=80&w=400",
    imagenDespues: "https://images.unsplash.com/photo-1544005313-94ddf0286df2?auto=format&fit=crop&q=80&w=400",
    testimonio: "Más que un entrenador, es un mentor que me enseñó a vivir saludable."
  },
  {
    id: 4,
    nombre: "Jorge D.",
    objetivo: "Preparación Competencia",
    resultado: "1er lugar local",
    imagenAntes: "https://images.unsplash.com/photo-1506794778202-cad84cf45f1d?auto=format&fit=crop&q=80&w=400",
    imagenDespues: "https://images.unsplash.com/photo-1519085360753-af0119f7cbe7?auto=format&fit=crop&q=80&w=400",
    testimonio: "Jairo me preparó para mi primera competencia y logré el primer lugar."
  }
];
---

<section id="transformations" class="py-20 px-4 sm:px-6 lg:px-8 bg-gradient-to-b from-white to-gray-50 dark:from-gray-900 dark:to-gray-800">
  <div class="max-w-7xl mx-auto">
    <div class="text-center mb-16">
      <span class="inline-block px-4 py-2 bg-primary-light/10 text-primary-dark dark:text-primary-light rounded-full text-sm font-bold uppercase tracking-wider mb-4">
        Resultados Reales
      </span>
      <h2 class="text-4xl lg:text-5xl font-black text-gray-900 dark:text-white mb-4">
        Transformaciones <span class="text-primary-dark dark:text-primary-light">Increíbles</span>
      </h2>
      <p class="text-xl text-gray-600 dark:text-gray-400 max-w-3xl mx-auto">
        Estas son solo algunas de las historias de éxito de personas que confiaron en el proceso
      </p>
    </div>

    <div class="grid md:grid-cols-2 gap-8">
      {transformations.map((transformation) => (
        <div class="transformation-card bg-white dark:bg-gray-900 rounded-2xl overflow-hidden shadow-lg hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2">
          <div class="relative h-64 overflow-hidden">
            <div class="before-after-slider" data-transformation-id={transformation.id}>
              <img 
                src={transformation.imagenAntes} 
                alt={`${transformation.nombre} - Antes`}
                class="absolute inset-0 w-full h-full object-cover"
              />
              <div class="after-image absolute inset-0 overflow-hidden" style="width: 50%;">
                <img 
                  src={transformation.imagenDespues} 
                  alt={`${transformation.nombre} - Después`}
                  class="absolute inset-0 w-full h-full object-cover"
                  style="width: 200%;"
                />
              </div>
              <div class="slider-handle absolute top-0 bottom-0 w-1 bg-white cursor-ew-resize" style="left: 50%;">
                <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-10 h-10 bg-white rounded-full shadow-lg flex items-center justify-center">
                  <svg class="w-6 h-6 text-gray-800" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 9l4-4 4 4m0 6l-4 4-4-4" />
                  </svg>
                </div>
              </div>
              <div class="absolute top-4 left-4 px-3 py-1 bg-black/70 text-white text-sm font-bold rounded-full">
                ANTES
              </div>
              <div class="absolute top-4 right-4 px-3 py-1 bg-primary-dark text-white text-sm font-bold rounded-full">
                DESPUÉS
              </div>
            </div>
          </div>
          
          <div class="p-6">
            <div class="flex items-start justify-between mb-4">
              <div>
                <h3 class="text-2xl font-bold text-gray-900 dark:text-white mb-1">
                  {transformation.nombre}
                </h3>
                <p class="text-sm text-primary-dark dark:text-primary-light font-semibold">
                  {transformation.objetivo}
                </p>
              </div>
              <div class="text-right">
                <div class="text-2xl font-black text-primary-dark dark:text-primary-light">
                  {transformation.resultado}
                </div>
              </div>
            </div>
            <p class="text-gray-600 dark:text-gray-400 italic">
              "{transformation.testimonio}"
            </p>
          </div>
        </div>
      ))}
    </div>

    <div class="mt-12 text-center">
      <p class="text-lg text-gray-600 dark:text-gray-400 mb-6">
        ¿Listo para ser la próxima historia de éxito?
      </p>
      <a 
        href="/contacto" 
        class="inline-flex items-center px-8 py-4 bg-primary-dark hover:bg-primary text-white font-bold rounded-full transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl"
      >
        Comienza Tu Transformación
        <svg class="w-5 h-5 ml-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6" />
        </svg>
      </a>
    </div>
  </div>
</section>

<script>
  function initBeforeAfter() {
    const sliders = document.querySelectorAll('.before-after-slider');
    
    sliders.forEach(slider => {
      const handle = slider.querySelector('.slider-handle') as HTMLElement;
      const afterImage = slider.querySelector('.after-image') as HTMLElement;
      let isDragging = false;

      const updatePosition = (x: number) => {
        const rect = slider.getBoundingClientRect();
        const position = Math.max(0, Math.min(x - rect.left, rect.width));
        const percentage = (position / rect.width) * 100;
        
        if (handle && afterImage) {
          handle.style.left = `${percentage}%`;
          afterImage.style.width = `${percentage}%`;
        }
      };

      handle?.addEventListener('mousedown', () => {
        isDragging = true;
      });

      document.addEventListener('mousemove', (e) => {
        if (isDragging) {
          updatePosition(e.clientX);
        }
      });

      document.addEventListener('mouseup', () => {
        isDragging = false;
      });

      // Touch events para móvil
      handle?.addEventListener('touchstart', () => {
        isDragging = true;
      });

      document.addEventListener('touchmove', (e) => {
        if (isDragging && e.touches[0]) {
          updatePosition(e.touches[0].clientX);
        }
      });

      document.addEventListener('touchend', () => {
        isDragging = false;
      });
    });
  }

  // Inicializar
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initBeforeAfter);
  } else {
    initBeforeAfter();
  }

  document.addEventListener('astro:after-swap', initBeforeAfter);
</script>

<style>
  .before-after-slider {
    position: relative;
    width: 100%;
    height: 100%;
    user-select: none;
  }

  .slider-handle {
    z-index: 10;
  }

  .after-image img {
    object-position: left center;
  }
</style>



